versione con AgentImpl[] agents; e Object lock