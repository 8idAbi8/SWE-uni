versione con Object[] agents; 
 e sostituisco Object lock con syncronized(agents)